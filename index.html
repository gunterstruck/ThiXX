<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title data-i18n="appTitle">THiXX NFC Tool</title>
    <link rel="stylesheet" href="/ThiXX/style.css">
    <link rel="manifest" href="/ThiXX/manifest.json">
    <link rel="icon" href="/ThiXX/favicon.ico" type="image/x-icon">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#f04e37">
    <!-- Apple Touch Icon (for iOS "Add to Home Screen") --><link rel="apple-touch-icon" href="/ThiXX/assets/THiXX_Icon_Grau6C6B66_Transparent_192x192.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/ThiXX/assets/THiXX_Icon_Grau6C6B66_Transparent_180x180.png">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <img src="/ThiXX/assets/THiXX_Icon_Grau6C6B66_Transparent_192x192.png" alt="THiXX Logo" class="app-logo">
                <h1 data-i18n="appName">THiXX NFC Tool</h1>
                <div class="theme-switcher">
                    <button class="theme-btn active" data-theme="dark" title="Dunkles Design aktivieren"><img src="/ThiXX/assets/icon-dark.svg" alt="Dark"></button>
                    <button class="theme-btn" data-theme="thixx" title="THiXX Design aktivieren"><img src="/ThiXX/assets/THiXX_Icon_Grau6C6B66_Transparent_512x512.png" alt="THiXX"></button>
                    <button class="theme-btn" data-theme="customer-brand" title="Kunden Design aktivieren"><img src="/ThiXX/assets/icon-512.png" alt="Customer"></button>
                </div>
            </div>
        </header>

        <nav class="tabs">
            <button class="tab-link active" data-tab="read-tab" data-i18n="tabRead">Lesen</button>
            <button class="tab-link" data-tab="write-tab" data-i18n="tabWrite">Schreiben</button>
            <button class="tab-link" data-tab="log-tab" data-i18n="tabLog">Protokoll</button>
            <button class="tab-link" data-tab="settings-tab" data-i18n="tabSettings">Einstellungen</button>
        </nav>

        <div id="read-tab" class="tab-content active">
            <div id="read-result" class="card collapsible expanded">
                <h2 data-i18n="nfcTagContent">Inhalt des NFC Tags</h2>
                <div class="collapsible-overlay">
                    <p data-i18n="clickToExpand">Klicken zum Ausklappen</p>
                </div>
                <div id="protocol-card" class="card-content">
                    <!-- Parsed NFC data will be displayed here --></div>
                <div id="doc-link-container" class="button-container">
                    <!-- Doc link button will be inserted here --></div>
            </div>

            <div id="read-actions" class="button-container">
                <button id="copy-to-form-btn" class="btn" data-i18n="copyToForm">In Formular kopieren</button>
            </div>

            <div id="raw-data-display" class="card collapsible">
                <h2 data-i18n="rawData">Rohdaten</h2>
                <div class="collapsible-overlay">
                    <p data-i18n="clickToExpand">Klicken zum Ausklappen</p>
                </div>
                <textarea id="raw-data-output" readonly rows="3"></textarea>
            </div>
            
             <div id="legal-info" class="card">
                <h2 data-i18n="legal.title">Rechtliche Hinweise</h2>
                <p data-i18n="legal.copyright">© 2024 THiXX GmbH. Alle Rechte vorbehalten.</p>
                <p><strong data-i18n="legal.responsible">Verantwortlich:</strong> <span data-i18n="legal.companyName">THiXX GmbH</span></p>
                <p><strong data-i18n="legal.address">Adresse:</strong> <span data-i18n="legal.companyAddress">Musterstraße 1, 12345 Musterstadt</span></p>
                <p><strong data-i18n="legal.contact">Kontakt:</strong> <a href="mailto:info@thixx.de">info@thixx.de</a></p>
                <p><strong data-i18n="legal.website">Website:</strong> <a href="https://www.thixx.de" target="_blank">www.thixx.de</a></p>
            </div>
        </div>

        <div id="write-tab" class="tab-content">
            <div id="nfc-fallback" class="card hidden">
                <h2 data-i18n="nfcUnsupported">NFC nicht unterstützt</h2>
                <p data-i18n="nfcUnsupportedMessage">Dein Gerät oder Browser unterstützt Web NFC nicht. Du kannst die Daten manuell eingeben und als JSON speichern/laden.</p>
            </div>

            <div id="write-form-container" class="card collapsible expanded">
                <h2 data-i18n="nfcWriteForm">NFC Schreibformular</h2>
                 <div class="collapsible-overlay">
                    <p data-i18n="clickToExpand">Klicken zum Ausklappen</p>
                </div>
                <form id="nfc-write-form">
                    <div class="input-group">
                        <label for="HK-Nr" data-i18n="form.hkNr">HK-Nr:</label>
                        <input type="text" id="HK-Nr" name="HK-Nr" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="KKS" data-i18n="form.kks">KKS:</label>
                        <input type="text" id="KKS" name="KKS" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="Leistung" data-i18n="form.leistung">Leistung (kW):</label>
                        <input type="number" step="0.1" id="Leistung" name="Leistung" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="Strom" data-i18n="form.strom">Strom (A):</label>
                        <input type="number" step="0.1" id="Strom" name="Strom" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="Spannung" data-i18n="form.spannung">Spannung (V):</label>
                        <input type="number" step="1" id="Spannung" name="Spannung" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="Widerstand" data-i18n="form.widerstand">Widerstand (Ω):</label>
                        <input type="number" step="0.1" id="Widerstand" name="Widerstand" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="Regler" data-i18n="form.regler">Regler (°C):</label>
                        <input type="number" step="1" id="Regler" name="Regler" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="Sicherheitsregler/Begrenzer" data-i18n="form.sicherheitsregler">Sicherheitsregler/Begrenzer (°C):</label>
                        <input type="number" step="1" id="Sicherheitsregler/Begrenzer" name="Sicherheitsregler/Begrenzer" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="Wächter" data-i18n="form.waechter">Wächter (°C):</label>
                        <input type="number" step="1" id="Wächter" name="Wächter" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="Projekt-Nr" data-i18n="form.projektNr">Projekt-Nr:</label>
                        <input type="text" id="Projekt-Nr" name="Projekt-Nr" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="Anzahl Heizkabeleinheiten" data-i18n="form.anzahlHeizkabeleinheiten">Anzahl Heizkabeleinheiten:</label>
                        <input type="number" step="1" id="Anzahl Heizkabeleinheiten" name="Anzahl Heizkabeleinheiten" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="Trennkasten" data-i18n="form.trennkasten">Trennkasten:</label>
                        <input type="number" step="1" id="Trennkasten" name="Trennkasten" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="Heizkabeltyp" data-i18n="form.heizkabeltyp">Heizkabeltyp:</label>
                        <input type="text" id="Heizkabeltyp" name="Heizkabeltyp" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="Schaltung" data-i18n="form.schaltung">Schaltung:</label>
                        <input type="text" id="Schaltung" name="Schaltung" placeholder=" ">
                    </div>
                    <div class="input-group checkbox-group">
                        <input type="checkbox" id="has_PT100" name="has_PT100">
                        <label for="has_PT100" data-i18n="form.pt100">PT 100:</label>
                        <input type="number" step="1" id="PT 100" name="PT 100" placeholder="0" disabled>
                    </div>
                    <div class="input-group checkbox-group">
                        <input type="checkbox" id="has_NiCr-Ni" name="has_NiCr-Ni">
                        <label for="has_NiCr-Ni" data-i18n="form.niCrNi">NiCr-Ni:</label>
                        <input type="number" step="1" id="NiCr-Ni" name="NiCr-Ni" placeholder="0" disabled>
                    </div>
                    <div class="input-group">
                        <label for="geprüft von" data-i18n="form.geprueftVon">geprüft von:</label>
                        <input type="text" id="geprüft von" name="geprüft von" placeholder=" ">
                    </div>
                    <div class="input-group">
                        <label for="am" data-i18n="form.am">am:</label>
                        <input type="date" id="am" name="am">
                    </div>
                     <div class="input-group">
                        <label for="Dokumentation" data-i18n="form.dokumentation">Dokumentation (URL):</label>
                        <input type="url" id="Dokumentation" name="Dokumentation" placeholder="https://example.com/doc.pdf">
                    </div>
                </form>
            </div>

            <!-- NEUE POSITION: Buttons für JSON-Speicherung/Laden sind jetzt hier --><div class="button-container">
                <button id="save-json-btn" class="btn" data-i18n="saveJson">Als JSON speichern</button>
                <label id="load-json-label" for="load-json-input" class="btn" data-i18n="loadJson">Aus JSON laden</label>
                <input type="file" id="load-json-input" accept="application/json" class="hidden">
            </div>

            <div id="payload-display" class="card collapsible">
                <h2 data-i18n="payloadPreview">Payload Vorschau</h2>
                 <div class="collapsible-overlay">
                    <p data-i18n="clickToExpand">Klicken zum Ausklappen</p>
                </div>
                <textarea id="payload-output" readonly rows="3"></textarea>
                <p id="payload-size"></p>
            </div>

            <div class="button-container">
                <button id="nfc-status-badge" class="nfc-badge" data-i18n="status.idle">NFC bereit</button>
            </div>
        </div>

        <div id="log-tab" class="tab-content">
            <div id="event-log-card" class="card">
                <h2 data-i18n="log.title">Ereignisprotokoll</h2>
                <div id="event-log-output" class="log-output">
                    <!-- Log entries will be displayed here --></div>
            </div>
        </div>

        <div id="settings-tab" class="tab-content">
            <div class="card">
                <h2 data-i18n="settings.title">Einstellungen</h2>
                <div class="setting-item">
                    <span data-i18n="settings.appVersion">App Version:</span>
                    <span>1.0.0</span> <!-- TODO: Dynamisch auslesen --></div>
                <div class="setting-item">
                    <span data-i18n="settings.nfcSupport">NFC Unterstützung:</span>
                    <span id="nfc-support-status"></span>
                </div>
                <div class="setting-item">
                    <span data-i18n="settings.checkForUpdates">Updates prüfen:</span>
                    <button id="check-for-update-btn" class="btn small" data-i18n="settings.checkNow">Jetzt prüfen</button>
                </div>
                <div id="update-banner" class="message-banner info hidden">
                    <span data-i18n="messages.updateAvailable">Ein neues Update ist verfügbar!</span>
                    <button id="reload-button" class="btn small" data-i18n="messages.updateReload">Neu laden</button>
                </div>
            </div>
        </div>
    </div>

    <div id="message-banner" class="message-banner hidden"></div>

    <script src="/ThiXX/app.js"></script>
</body>
</html>
